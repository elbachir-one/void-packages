# Template file for 'chuck'
pkgname=chuck
version=1.5.4.3
revision=1
build_wrksrc=src
build_style=gnu-makefile
make_use_env=yes
make_build_target="linux-jack"
hostmakedepends="bison flex"
makedepends="jack-devel libsndfile-devel liblo-devel pkg-config"
short_desc="Concurrent, on-the-fly audio programming language"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-2.0-or-later"
homepage="https://chuck.cs.princeton.edu"
changelog="https://chuck.cs.princeton.edu/release/VERSIONS"
distfiles="https://chuck.cs.princeton.edu/release/files/$pkgname-$version.tgz"
checksum=bba453c3d9ec0c10f04fdc87d5bfb3bab98961a891c8cc88c32827de5cc35d11


post_extract() {
	# use CC, CXX and LD from environment
	vsed -e '/^CC=/d' -e '/^CXX=/d' -e '/^LD=/d' -i src/makefile -i src/core/makefile
	# fix parallel builds for make in sub directories
	vsed -e 's/^\tmake /\t+$(MAKE) /' -i src/makefile
	# use CC instead of LD when linking
	vsed -e 's/$(LD)/$(CC)/g' -i src/makefile
}

do_install() {
	vbin chuck
}
